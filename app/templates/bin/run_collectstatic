#!/usr/bin/env bash
set -eo pipefail

indent() {
    RE="s/^/       /"
    [ $(uname) == "Darwin" ] && sed -l "$RE" || sed -u "$RE"
}

PROJECT_NAME=<%= projectName %>

MANAGE_FILE=$(find . -maxdepth 3 -type f -name 'manage.py' | head -1)
MANAGE_FILE=${MANAGE_FILE:2}

# Add more if you want to ignore more files for collectstatic
IGNORES[0]="-i *.html"
IGNORES[1]="-i *.scss"
IGNORES[2]="-i *.less"

echo "-----> Collecting static files"
python $MANAGE_FILE collectstatic --noinput --settings=$PROJECT_NAME.settings.prod ${IGNORES[@]}  2>&1 | sed '/^Copying/d;/^$/d;/^ /d' | indent

echo
